FROM debian:bullseye-slim

# Imposta working directory
WORKDIR /app

# ðŸ”¹ Installa dipendenze
RUN apt-get update && apt-get install -y \
    curl \
    unzip \
    zip \
    bash \
    less \
    groff \
    awscli \
    ca-certificates \
    git \
    && rm -rf /var/lib/apt/lists/*

# ðŸ”¹ Copia tutto il codice
COPY . .

# ðŸ”¹ Installa Go (manuale perchÃ© non incluso)
RUN curl -LO https://golang.org/dl/go1.21.0.linux-amd64.tar.gz && \
    tar -C /usr/local -xzf go1.21.0.linux-amd64.tar.gz && \
    rm go1.21.0.linux-amd64.tar.gz

ENV PATH="/usr/local/go/bin:$PATH"

# ðŸ”¹ Compila il codice
RUN go build -o master_bin ./master

# ðŸ”¹ Entry point
CMD ["./master_bin"]
